<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      >
    <h:head>
        <link rel="stylesheet" type="text/css" href="css/theme.css"/>
        <link type="text/css" href="bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
        <link type="text/css" href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet"/>
        <link type="text/css" href="images/icons/css/font-awesome.css" rel="stylesheet"/>
        <link type="text/css" href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600' rel='stylesheet'/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta> 
        <link rel="shortcut icon" href="../../../resources/img/airplane-black-glyph-icon-flight-2239097-transformed.ico"/>
        <title>AeroJet: Usuarios Panel</title>
    </h:head>
    <h:body>
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-inverse-collapse">
                    <i class="icon-reorder shaded"></i></a><a class="brand" href="indexadmin.html">Admin Panel </a>
                <div class="nav-collapse collapse navbar-inverse-collapse">
                    <ul class="nav nav-icons">
                        <li class="active"><a href="#"><i class="icon-envelope"></i></a></li>
                        <li><a href="#"><i class="icon-eye-open"></i></a></li>
                        <li><a href="#"><i class="icon-bar-chart"></i></a></li>
                    </ul>
                    <h:form class="navbar-search pull-left input-append">
                        <!--<input type="text" class="span3">
                        <button class="btn" type="button">
                            <i class="icon-search"></i>
                        </button>-->
                    </h:form>
                    <ul class="nav pull-right">
                        <li><a href="#">Apoyo </a></li>
                        <li class="nav-user dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <img src="images/user.png" class="nav-avatar" />
                                <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="#">Your Profile</a></li>
                                <li><a href="#">Edit Profile</a></li>
                                <li><a href="#">Account Settings</a></li>
                                <li class="divider"></li>
                                <li><a href="#">Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <!-- /.nav-collapse -->
            </div>
        </div>
        <!-- /navbar-inner -->
    </div>
        
        <div class="wrapper">
            <div class="container">
                <div class="row">
                    <div class="span3">
                        <div class="sidebar">
                        <ul class="widget widget-menu unstyled">
                            <li class="active"><a href="indexadmin.xhtml"><i class="menu-icon icon-dashboard"></i>Panel
                                </a></li>
                            <li><a href="activity.html"><i class="menu-icon icon-bullhorn"></i>Comentarios </a>
                            </li>
                            <li><a href="message.html"><i class="menu-icon icon-inbox"></i>Mensajes <b
                                        class="label green pull-right">
                                        11</b> </a></li>
                        </ul>
                        <!--/.widget-nav-->
                        <ul class="widget widget-menu unstyled">
                                <li><a href="/AeroJet-Java/faces/resources/pages/vista-administrador/usuariosadmin.xhtml"><i class="icon-user" style="margin-right: 10px;"></i>Usuarios</a></li>
                                <li><a href="/AeroJet-Java/faces/resources/pages/vista-administrador/avionesAdmin.xhtml"><i class="menu-icon icon-book"></i>Aviones</a></li>
                                <li><a href="charts.html"><i class="menu-icon icon-bar-chart"></i>Vuelos </a></li>
                                <li><a href="/AeroJet-Java/faces/resources/pages/vista-administrador/rutasAdmin.xhtml"><i class="menu-icon icon-bar-chart"></i>Rutas </a></li>
                                <li><a href="/AeroJet-Java/faces/resources/pages/vista-administrador/tarifasAdmin.xhtml"><i class="menu-icon icon-bar-chart"></i>Tarifas </a></li>
                        </ul>
                        <!--/.widget-nav-->
                        </div>
                    </div>
                    <div class="span9">
                        <div class="content">
                            <div class="btn-controls">
                                <div class="btn-box-row row-fluid">
                                   <!-- #{usuario_data.init()} -->
        <h:form>
            <p:commandButton value="Agregar Usuario" actionListener="#{usuario_data.init()}" oncomplete="PF('dialogoAgregar').show();" update=":formAgregar"/>
            <p:separator/>
        </h:form>
        
        <h:form id="formListado">
            <p:dataTable id="tablaUsuarios" paginator="true" paginatorPosition="bottom" rows="10" var="usuario" value="#{usuario_data.usuarios}" emptyMessage="No existen usuarios">
                            <p:column headerText="Id">
                                <h:outputText value="#{usuario.id}" />
                            </p:column>
                            <p:column headerText="Usuario">
                                <h:outputText value="#{usuario.nombreUsuario}" />
                            </p:column>
                            <p:column headerText="Contraseña">
                                <h:outputText value="#{usuario.contraseña}" />
                            </p:column>
                            <p:column headerText="Correo">
                                <h:outputText value="#{usuario.email}" />
                            </p:column>
                            <p:column headerText="Modificar" style="text-align: center">
                                <p:commandButton icon="pi pi-pencil" title="Modificar" oncomplete="PF('dialogoModificar').show();" update=":formModificar">
                                    <f:setPropertyActionListener target="#{usuario_data.usuarioSeleccionado}" value="#{usuario}"/>
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="Eliminar" style="text-align: center">
                                <p:commandButton icon="pi pi-trash" title="Eliminar" oncomplete="PF('dialogoEliminar').show();" update=":formEliminar">
                                    <f:setPropertyActionListener target="#{usuario_data.usuarioSeleccionado}" value="#{usuario}" />
                                </p:commandButton>
                            </p:column>
              </p:dataTable>
        </h:form>
        
        
        <h:form id="formAgregar">
                        <p:dialog id="dlgAgregar" header="Agregar Usuario" widgetVar="dialogoAgregar" resizable="false" showEffect="fade" hideEffect="fade" modal="true">
                            <p:panelGrid columns="2" style="margin: 0 auto;">                                
                                <p:outputLabel value="Nombre: "/>
                                <p:inputText value="#{usuario_data.nombreUsuario}"/>                                
                                <p:outputLabel value="Contraseña: "/>
                                <p:inputText value="#{usuario_data.password}"/>                                
                                <p:outputLabel value="Correo: "/>
                                <p:inputText value="#{usuario_data.email}"/>
                            </p:panelGrid>
                            <p:commandButton  value="Guardar" actionListener="#{usuario_data.registrar(usuario_data.nombreUsuario,usuario_data.password,usuario_data.email)}" update=":formListado:tablaUsuarios" oncomplete="PF('dialogoAgregar').hide();"/>
                            <p:commandButton  value="Cancelar" onclick="PF('dialogoAgregar').hide();"/>
                        </p:dialog>
        </h:form>

        <h:form id="formModificar">
            <p:dialog id="dlgModificar" header="Modificar Usuario" widgetVar="dialogoModificar" resizable="false" showEffect="fade" hideEffect="fade" modal="true">
            <p:panelGrid columns="2" style="margin: 0 auto;">
                <p:outputLabel value="Usuario:"/>
                <p:inputText value="#{usuario_data.usuarioSeleccionado.nombreUsuario}"/>

                <p:outputLabel value="Contraseña:"/>
                <p:inputText value="#{usuario_data.usuarioSeleccionado.contraseña}"/>

                <p:outputLabel value="Correo:"/>
                <p:inputText value="#{usuario_data.usuarioSeleccionado.email}"/>
                
            </p:panelGrid>
                <p:commandButton value="Guardar" actionListener="#{usuario_data.actualizarUsuario(usuario_data.usuarioSeleccionado.id, usuario_data.usuarioSeleccionado.nombreUsuario, 
                                                                   usuario_data.usuarioSeleccionado.contraseña, usuario_data.usuarioSeleccionado.email)}" update=":formListado:tablaUsuarios" oncomplete="PF('dialogoModificar').hide();"/>
                <p:commandButton value="Cancelar" onclick="PF('dialogoModificar').hide();"/>
            </p:dialog>
        </h:form>
                                   
        <h:form id="formEliminar">
                        <p:dialog id="dlgEliminar" header="Eliminar Usuario" widgetVar="dialogoEliminar" resizable="false" showEffect="fade" hideEffect="fade" modal="true">
                            <h:outputText value="Desea eliminar este registro con el id: #{usuario_data.usuarioSeleccionado.id} ?"/>
                            <br/> <br/>
                            <div style="display: flex; justify-content: space-between;">
                                <p:commandButton  value="Si" update=":formListado:tablaUsuarios" oncomplete="PF('dialogoEliminar').hide();">
                                    <p:ajax listener="#{usuario_data.eliminarUsuario(usuario_data.usuarioSeleccionado.id, event)}" />
                                </p:commandButton>
                            <p:commandButton  value="No" onclick="PF('dialogoEliminar').hide();"/>
                            </div>
                        </p:dialog>
        </h:form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </h:body>
</html>
